<!DOCTYPE HTML>
<html>


<!-- Mirrored from learn.javascript.ru/article/range-textrange-selection/setSelection/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Apr 2023 11:34:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8">
</head>

<body>

  <div id="ex5" style="border:1px dashed #999; color:#666; background:#EEE; padding:2px 5px; margin:10px 0;">
    Снова будем выделять <span>бабулю</span>, на этот раз без поиска.
  </div>
  <div>
    <input onclick="setSelection()" type="button" value="Выделить бабулю">
  </div>
  <script>
    function setSelection() {
      var target = document.getElementById('ex5').getElementsByTagName('span')[0];
      var rng, sel;
      if (document.createRange) {
        rng = document.createRange();
        rng.selectNode(target)
        sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(rng);
      } else {
        var rng = document.body.createTextRange();
        rng.moveToElementText(target);
        rng.select();
      }
    }
  </script>


</body>


<!-- Mirrored from learn.javascript.ru/article/range-textrange-selection/setSelection/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Apr 2023 11:34:06 GMT -->
</html>